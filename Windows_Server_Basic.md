# Windows Server 基礎
- **1.安裝與初始配置**
- 安裝Windows Server
- 選擇安裝類型：在安裝過程中，選擇適當的版本（如Windows Server 2019、2022）和安裝選項（Server with Desktop Experience或Server Core）。
- 設定初始設定：包括設定管理員密碼、設定網路介面（靜態IP位址、子網路遮罩、預設閘道和DNS伺服器）、以及加入網域或設定工作群組。
- 使用伺服器管理員設定伺服器
- 新增伺服器角色和功能：使用「伺服器管理員」中的「新增角色和功能」精靈，選擇安裝所需的伺服器角色（如IIS、檔案和儲存服務）和功能（如.NET Framework、遠端桌面服務） 。
- 啟用遠端桌面：在「系統屬性」中的「遠端」選項卡，啟用遠端桌面，以便遠端管理伺服器。
- **2.用戶和群組管理**
- 建立使用者和群組
- 本機使用者和群組：透過「電腦管理」中的「本機使用者和群組」建立本機使用者和群組。可以為使用者指派不同的群組權限，例如將使用者加入「Administrators」群組以賦予管理員權限。
- Active Directory：如果伺服器是網域控制站，可以使用「Active Directory使用者和電腦」管理網域使用者和群組。
- 權限配置
- 資料夾權限：在資料夾的「屬性」中，使用「安全性」標籤設定使用者和群組的存取權限（讀取、寫入、修改等）。
- 共用資料夾：透過右鍵資料夾選擇「共用」選項，設定網路共用權限，並設定NTFS權限和共用權限。
- **3.網路和遠端管理**
- 設定網路設定
- 靜態IP設定：透過「網路和共用中心」或使用PowerShell指令（如New-NetIPAddress）設定伺服器的靜態IP位址，確保伺服器在網路中的固定位置。
- DNS和DHCP設定：如果伺服器需要提供DNS或DHCP服務，使用伺服器管理員安裝對應角色，並進行設定。
- 使用遠端桌面和PowerShell遠端管理
- 遠端桌面連線：透過遠端桌面連線（RDP）進行伺服器的遠端管理，設定並監控伺服器狀態。
- PowerShell遠端管理：使用PowerShell的遠端會話（如Enter-PSSession或Invoke-Command）執行遠端管理任務，這對於批次管理多台伺服器非常有用。
- **4.儲存和磁碟管理**
- 分割區和格式化磁碟
- 磁碟管理工具：在「電腦管理」中的「磁碟管理」工具中建立、格式化和指派新分割區。可以選擇檔案系統（如NTFS或ReFS）和磁碟區標。
- 儲存池配置：透過「儲存池」功能，將多個實體磁碟組合成一個邏輯儲存池，並建立儲存空間以實現冗餘和擴充性。
- 共享和配額管理
- 配置共用資料夾：使用「檔案和儲存服務」管理共用資料夾，並為使用者或群組配置共用和NTFS權限。
- 設定磁碟配額：在「磁碟管理」中為使用者或群組設定磁碟配額，以限制他們的儲存使用量。
- **5.伺服器角色和功能管理**
- 安裝和管理伺服器角色
- IIS安裝與設定：透過「伺服器管理員」安裝Internet Information Services（IIS），並設定網站、應用程式集區、安全性設定（SSL/TLS憑證）等。
- 網域控制器設定：使用「Active Directory網域服務」安裝精靈設定網域控制器，並使用「DNS管理」設定網域名稱解析。
- 監控和維護伺服器角色
- 監控IIS日誌：定期檢查IIS日誌文件，監控存取狀況、錯誤和安全事件。可以透過「事件檢視器」或「日誌分析工具」進行檢查。
- 管理群組原則：透過「群組原則管理」控制使用者和電腦的安全性原則、軟體安裝和系統配置。
- **6.備份和恢復**
- 配置和執行備份
- 使用Windows Server Backup：設定定期備份策略，包括系統狀態、檔案和應用程式備份。選擇備份類型（完整備份、差異備份、增量備份）並設定備份計畫。
- 備份至網路儲存：將備份資料儲存至網路共用或專用備份設備，確保資料的安全性和可恢復性。
- 恢復操作
- 系統還原：使用備份的資料進行系統還原，還原到備份時的狀態。可以選擇還原整個系統或特定的檔案和資料夾。
- 災難復原計畫：定期測試備份和復原流程，確保在實際災難發生時可以快速復原系統。
- **7.效能監控和優化**
- 監控系統效能
- 使用工作管理員和效能監視器：即時監控伺服器的CPU、記憶體、磁碟和網路使用情況。使用「效能監視器」設定效能計數器，記錄並分析長期效能數據。
- 資源監視器：檢查具體的資源使用情況，例如哪些進程消耗最多的CPU或內存，並根據需求進行最佳化或調整。
- 優化系統效能
- 調整虛擬記憶體：根據伺服器負載調整虛擬記憶體大小，確保系統在高負載情況下保持穩定。
- 最佳化磁碟效能：定期進行磁碟碎片整理（如果使用HDD）或調整儲存策略，以提高儲存效能。
- **8.安全管理**
- 更新管理
- 設定自動更新：透過「Windows Update」設定自動更新，確保伺服器始終套用最新的安全性修補程式和系統更新。
- 使用WSUS：在大型環境中使用Windows Server Update Services（WSUS）集中管理和分發更新。
- 配置防火牆和安全性策略
- Windows防火牆設定：使用「進階安全性Windows防火牆」建立入站和出站規則，控制哪些流量可以進入或離開伺服器。
- 群組原則配置：透過「群組原則管理」設定密碼原則、帳戶鎖定原則和其他安全性設置，以提高伺服器的整體安全性。
- **9.故障排查和日誌管理**
- 排除常見故障
- 使用事件檢視器：檢視系統、應用程式和安全性日誌，以識別可能導致系統故障或效能問題的事件。
- 使用Windows故障排查工具：執行內建的故障排查工具，自動偵測並修復常見問題，如網路連線問題、硬體相容性問​​題等。
- 定期日誌分析
- 定期檢查安全日誌：透過「事件檢視器」檢查安全日誌，識別潛在的安全威脅或未授權的存取行為。
- 設定日誌轉儲和分析工具：將日誌檔案定期轉儲到集中存儲，並使用分析工具（如Splunk、ELK Stack）對日誌進行深入分析。
